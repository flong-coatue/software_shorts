import type {
  IncomeStatementRow,
  BalanceSheetRow,
  CashFlowRow,
  Financials,
} from "@/lib/types";

// ── Apple Financials (AAPL) ─────────────────────────────────────────────────
// Realistic Apple data: FY ends late September.
// Quarters: Q1 (Oct-Dec), Q2 (Jan-Mar), Q3 (Apr-Jun), Q4 (Jul-Sep)
// 8 quarters: Q1 FY24 through Q4 FY25, plus FY2024 and FY2025 annuals.

const aaplIncomeStatement: IncomeStatementRow[] = [
  // ── Annual ──
  {
    period: "FY2024",
    periodEnd: "2024-09-28",
    isAnnual: true,
    revenue: 394_328_000_000,
    costOfRevenue: 210_352_000_000,
    grossProfit: 183_976_000_000,
    grossMargin: 46.7,
    researchAndDevelopment: 31_370_000_000,
    sellingGeneralAdmin: 25_190_000_000,
    totalOperatingExpenses: 266_912_000_000,
    operatingIncome: 127_416_000_000,
    operatingMargin: 32.3,
    interestExpense: 3_280_000_000,
    otherIncome: 1_620_000_000,
    pretaxIncome: 125_756_000_000,
    incomeTax: 20_930_000_000,
    netIncome: 104_826_000_000,
    netMargin: 26.6,
    eps: 6.74,
    epsDiluted: 6.68,
    sharesOutstanding: 15_550_000_000,
    sharesDiluted: 15_690_000_000,
    ebitda: 139_820_000_000,
  },
  {
    period: "FY2025",
    periodEnd: "2025-09-27",
    isAnnual: true,
    revenue: 414_700_000_000,
    costOfRevenue: 219_800_000_000,
    grossProfit: 194_900_000_000,
    grossMargin: 47.0,
    researchAndDevelopment: 33_400_000_000,
    sellingGeneralAdmin: 26_100_000_000,
    totalOperatingExpenses: 279_300_000_000,
    operatingIncome: 135_400_000_000,
    operatingMargin: 32.7,
    interestExpense: 3_100_000_000,
    otherIncome: 1_800_000_000,
    pretaxIncome: 134_100_000_000,
    incomeTax: 22_200_000_000,
    netIncome: 111_900_000_000,
    netMargin: 27.0,
    eps: 7.30,
    epsDiluted: 7.24,
    sharesOutstanding: 15_330_000_000,
    sharesDiluted: 15_460_000_000,
    ebitda: 148_500_000_000,
  },
  // ── Quarterly ──
  {
    period: "Q1 FY24",
    periodEnd: "2023-12-30",
    isAnnual: false,
    revenue: 119_580_000_000,
    costOfRevenue: 64_720_000_000,
    grossProfit: 54_860_000_000,
    grossMargin: 45.9,
    researchAndDevelopment: 7_700_000_000,
    sellingGeneralAdmin: 6_780_000_000,
    totalOperatingExpenses: 79_200_000_000,
    operatingIncome: 40_380_000_000,
    operatingMargin: 33.8,
    interestExpense: 830_000_000,
    otherIncome: 390_000_000,
    pretaxIncome: 39_940_000_000,
    incomeTax: 6_620_000_000,
    netIncome: 33_320_000_000,
    netMargin: 27.9,
    eps: 2.11,
    epsDiluted: 2.10,
    sharesOutstanding: 15_790_000_000,
    sharesDiluted: 15_870_000_000,
    ebitda: 43_500_000_000,
  },
  {
    period: "Q2 FY24",
    periodEnd: "2024-03-30",
    isAnnual: false,
    revenue: 90_750_000_000,
    costOfRevenue: 48_640_000_000,
    grossProfit: 42_110_000_000,
    grossMargin: 46.4,
    researchAndDevelopment: 7_900_000_000,
    sellingGeneralAdmin: 6_320_000_000,
    totalOperatingExpenses: 62_860_000_000,
    operatingIncome: 27_890_000_000,
    operatingMargin: 30.7,
    interestExpense: 820_000_000,
    otherIncome: 430_000_000,
    pretaxIncome: 27_500_000_000,
    incomeTax: 4_560_000_000,
    netIncome: 22_940_000_000,
    netMargin: 25.3,
    eps: 1.47,
    epsDiluted: 1.46,
    sharesOutstanding: 15_620_000_000,
    sharesDiluted: 15_740_000_000,
    ebitda: 30_800_000_000,
  },
  {
    period: "Q3 FY24",
    periodEnd: "2024-06-29",
    isAnnual: false,
    revenue: 94_930_000_000,
    costOfRevenue: 50_390_000_000,
    grossProfit: 44_540_000_000,
    grossMargin: 46.9,
    researchAndDevelopment: 8_010_000_000,
    sellingGeneralAdmin: 6_250_000_000,
    totalOperatingExpenses: 64_650_000_000,
    operatingIncome: 30_280_000_000,
    operatingMargin: 31.9,
    interestExpense: 810_000_000,
    otherIncome: 400_000_000,
    pretaxIncome: 29_870_000_000,
    incomeTax: 4_960_000_000,
    netIncome: 24_910_000_000,
    netMargin: 26.2,
    eps: 1.60,
    epsDiluted: 1.58,
    sharesOutstanding: 15_530_000_000,
    sharesDiluted: 15_660_000_000,
    ebitda: 33_400_000_000,
  },
  {
    period: "Q4 FY24",
    periodEnd: "2024-09-28",
    isAnnual: false,
    revenue: 89_068_000_000,
    costOfRevenue: 46_602_000_000,
    grossProfit: 42_466_000_000,
    grossMargin: 47.7,
    researchAndDevelopment: 7_760_000_000,
    sellingGeneralAdmin: 5_840_000_000,
    totalOperatingExpenses: 60_202_000_000,
    operatingIncome: 28_866_000_000,
    operatingMargin: 32.4,
    interestExpense: 820_000_000,
    otherIncome: 400_000_000,
    pretaxIncome: 28_446_000_000,
    incomeTax: 4_790_000_000,
    netIncome: 23_656_000_000,
    netMargin: 26.6,
    eps: 1.55,
    epsDiluted: 1.54,
    sharesOutstanding: 15_400_000_000,
    sharesDiluted: 15_530_000_000,
    ebitda: 32_120_000_000,
  },
  {
    period: "Q1 FY25",
    periodEnd: "2024-12-28",
    isAnnual: false,
    revenue: 124_300_000_000,
    costOfRevenue: 66_500_000_000,
    grossProfit: 57_800_000_000,
    grossMargin: 46.5,
    researchAndDevelopment: 8_200_000_000,
    sellingGeneralAdmin: 7_050_000_000,
    totalOperatingExpenses: 81_750_000_000,
    operatingIncome: 42_550_000_000,
    operatingMargin: 34.2,
    interestExpense: 790_000_000,
    otherIncome: 450_000_000,
    pretaxIncome: 42_210_000_000,
    incomeTax: 7_000_000_000,
    netIncome: 35_210_000_000,
    netMargin: 28.3,
    eps: 2.30,
    epsDiluted: 2.28,
    sharesOutstanding: 15_310_000_000,
    sharesDiluted: 15_440_000_000,
    ebitda: 46_200_000_000,
  },
  {
    period: "Q2 FY25",
    periodEnd: "2025-03-29",
    isAnnual: false,
    revenue: 95_400_000_000,
    costOfRevenue: 50_300_000_000,
    grossProfit: 45_100_000_000,
    grossMargin: 47.3,
    researchAndDevelopment: 8_400_000_000,
    sellingGeneralAdmin: 6_500_000_000,
    totalOperatingExpenses: 65_200_000_000,
    operatingIncome: 30_200_000_000,
    operatingMargin: 31.7,
    interestExpense: 780_000_000,
    otherIncome: 460_000_000,
    pretaxIncome: 29_880_000_000,
    incomeTax: 4_950_000_000,
    netIncome: 24_930_000_000,
    netMargin: 26.1,
    eps: 1.63,
    epsDiluted: 1.61,
    sharesOutstanding: 15_290_000_000,
    sharesDiluted: 15_420_000_000,
    ebitda: 33_600_000_000,
  },
  {
    period: "Q3 FY25",
    periodEnd: "2025-06-28",
    isAnnual: false,
    revenue: 98_200_000_000,
    costOfRevenue: 51_800_000_000,
    grossProfit: 46_400_000_000,
    grossMargin: 47.3,
    researchAndDevelopment: 8_500_000_000,
    sellingGeneralAdmin: 6_400_000_000,
    totalOperatingExpenses: 66_700_000_000,
    operatingIncome: 31_500_000_000,
    operatingMargin: 32.1,
    interestExpense: 770_000_000,
    otherIncome: 470_000_000,
    pretaxIncome: 31_200_000_000,
    incomeTax: 5_170_000_000,
    netIncome: 26_030_000_000,
    netMargin: 26.5,
    eps: 1.70,
    epsDiluted: 1.69,
    sharesOutstanding: 15_260_000_000,
    sharesDiluted: 15_390_000_000,
    ebitda: 35_000_000_000,
  },
  {
    period: "Q4 FY25",
    periodEnd: "2025-09-27",
    isAnnual: false,
    revenue: 96_800_000_000,
    costOfRevenue: 51_200_000_000,
    grossProfit: 45_600_000_000,
    grossMargin: 47.1,
    researchAndDevelopment: 8_300_000_000,
    sellingGeneralAdmin: 6_150_000_000,
    totalOperatingExpenses: 65_650_000_000,
    operatingIncome: 31_150_000_000,
    operatingMargin: 32.2,
    interestExpense: 760_000_000,
    otherIncome: 420_000_000,
    pretaxIncome: 30_810_000_000,
    incomeTax: 5_080_000_000,
    netIncome: 25_730_000_000,
    netMargin: 26.6,
    eps: 1.68,
    epsDiluted: 1.67,
    sharesOutstanding: 15_230_000_000,
    sharesDiluted: 15_360_000_000,
    ebitda: 33_700_000_000,
  },
];

const aaplBalanceSheet: BalanceSheetRow[] = [
  // ── Annual ──
  {
    period: "FY2024",
    periodEnd: "2024-09-28",
    isAnnual: true,
    cashAndEquivalents: 29_940_000_000,
    shortTermInvestments: 35_230_000_000,
    totalCash: 65_170_000_000,
    accountsReceivable: 32_840_000_000,
    inventory: 7_290_000_000,
    totalCurrentAssets: 133_640_000_000,
    propertyPlantEquipment: 44_800_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 352_580_000_000,
    accountsPayable: 68_960_000_000,
    shortTermDebt: 10_910_000_000,
    totalCurrentLiabilities: 134_850_000_000,
    longTermDebt: 96_800_000_000,
    totalLiabilities: 290_440_000_000,
    totalStockholdersEquity: 62_140_000_000,
    retainedEarnings: -19_150_000_000,
    totalLiabilitiesAndEquity: 352_580_000_000,
  },
  {
    period: "FY2025",
    periodEnd: "2025-09-27",
    isAnnual: true,
    cashAndEquivalents: 32_500_000_000,
    shortTermInvestments: 33_100_000_000,
    totalCash: 65_600_000_000,
    accountsReceivable: 35_200_000_000,
    inventory: 7_800_000_000,
    totalCurrentAssets: 138_200_000_000,
    propertyPlantEquipment: 47_200_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 360_400_000_000,
    accountsPayable: 72_300_000_000,
    shortTermDebt: 9_800_000_000,
    totalCurrentLiabilities: 138_600_000_000,
    longTermDebt: 91_200_000_000,
    totalLiabilities: 295_500_000_000,
    totalStockholdersEquity: 64_900_000_000,
    retainedEarnings: -14_800_000_000,
    totalLiabilitiesAndEquity: 360_400_000_000,
  },
  // ── Quarterly (last 8 quarters) ──
  {
    period: "Q1 FY24",
    periodEnd: "2023-12-30",
    isAnnual: false,
    cashAndEquivalents: 40_760_000_000,
    shortTermInvestments: 32_340_000_000,
    totalCash: 73_100_000_000,
    accountsReceivable: 29_510_000_000,
    inventory: 6_510_000_000,
    totalCurrentAssets: 143_560_000_000,
    propertyPlantEquipment: 43_720_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 353_510_000_000,
    accountsPayable: 58_140_000_000,
    shortTermDebt: 12_100_000_000,
    totalCurrentLiabilities: 133_970_000_000,
    longTermDebt: 100_540_000_000,
    totalLiabilities: 290_470_000_000,
    totalStockholdersEquity: 63_040_000_000,
    retainedEarnings: -23_060_000_000,
    totalLiabilitiesAndEquity: 353_510_000_000,
  },
  {
    period: "Q2 FY24",
    periodEnd: "2024-03-30",
    isAnnual: false,
    cashAndEquivalents: 32_690_000_000,
    shortTermInvestments: 34_450_000_000,
    totalCash: 67_140_000_000,
    accountsReceivable: 25_350_000_000,
    inventory: 6_230_000_000,
    totalCurrentAssets: 128_400_000_000,
    propertyPlantEquipment: 44_060_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 337_410_000_000,
    accountsPayable: 53_670_000_000,
    shortTermDebt: 11_980_000_000,
    totalCurrentLiabilities: 123_710_000_000,
    longTermDebt: 98_240_000_000,
    totalLiabilities: 277_370_000_000,
    totalStockholdersEquity: 60_040_000_000,
    retainedEarnings: -22_580_000_000,
    totalLiabilitiesAndEquity: 337_410_000_000,
  },
  {
    period: "Q3 FY24",
    periodEnd: "2024-06-29",
    isAnnual: false,
    cashAndEquivalents: 25_570_000_000,
    shortTermInvestments: 36_190_000_000,
    totalCash: 61_760_000_000,
    accountsReceivable: 28_430_000_000,
    inventory: 6_170_000_000,
    totalCurrentAssets: 126_960_000_000,
    propertyPlantEquipment: 44_510_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 339_950_000_000,
    accountsPayable: 55_310_000_000,
    shortTermDebt: 12_180_000_000,
    totalCurrentLiabilities: 125_200_000_000,
    longTermDebt: 97_360_000_000,
    totalLiabilities: 279_200_000_000,
    totalStockholdersEquity: 60_750_000_000,
    retainedEarnings: -21_190_000_000,
    totalLiabilitiesAndEquity: 339_950_000_000,
  },
  {
    period: "Q4 FY24",
    periodEnd: "2024-09-28",
    isAnnual: false,
    cashAndEquivalents: 29_940_000_000,
    shortTermInvestments: 35_230_000_000,
    totalCash: 65_170_000_000,
    accountsReceivable: 32_840_000_000,
    inventory: 7_290_000_000,
    totalCurrentAssets: 133_640_000_000,
    propertyPlantEquipment: 44_800_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 352_580_000_000,
    accountsPayable: 68_960_000_000,
    shortTermDebt: 10_910_000_000,
    totalCurrentLiabilities: 134_850_000_000,
    longTermDebt: 96_800_000_000,
    totalLiabilities: 290_440_000_000,
    totalStockholdersEquity: 62_140_000_000,
    retainedEarnings: -19_150_000_000,
    totalLiabilitiesAndEquity: 352_580_000_000,
  },
  {
    period: "Q1 FY25",
    periodEnd: "2024-12-28",
    isAnnual: false,
    cashAndEquivalents: 44_200_000_000,
    shortTermInvestments: 31_800_000_000,
    totalCash: 76_000_000_000,
    accountsReceivable: 31_600_000_000,
    inventory: 7_100_000_000,
    totalCurrentAssets: 148_300_000_000,
    propertyPlantEquipment: 45_800_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 364_200_000_000,
    accountsPayable: 62_400_000_000,
    shortTermDebt: 10_200_000_000,
    totalCurrentLiabilities: 140_800_000_000,
    longTermDebt: 94_600_000_000,
    totalLiabilities: 296_200_000_000,
    totalStockholdersEquity: 68_000_000_000,
    retainedEarnings: -15_200_000_000,
    totalLiabilitiesAndEquity: 364_200_000_000,
  },
  {
    period: "Q2 FY25",
    periodEnd: "2025-03-29",
    isAnnual: false,
    cashAndEquivalents: 35_100_000_000,
    shortTermInvestments: 33_500_000_000,
    totalCash: 68_600_000_000,
    accountsReceivable: 27_400_000_000,
    inventory: 6_900_000_000,
    totalCurrentAssets: 134_800_000_000,
    propertyPlantEquipment: 46_200_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 353_200_000_000,
    accountsPayable: 57_800_000_000,
    shortTermDebt: 9_900_000_000,
    totalCurrentLiabilities: 130_400_000_000,
    longTermDebt: 93_100_000_000,
    totalLiabilities: 289_600_000_000,
    totalStockholdersEquity: 63_600_000_000,
    retainedEarnings: -17_400_000_000,
    totalLiabilitiesAndEquity: 353_200_000_000,
  },
  {
    period: "Q3 FY25",
    periodEnd: "2025-06-28",
    isAnnual: false,
    cashAndEquivalents: 28_600_000_000,
    shortTermInvestments: 34_800_000_000,
    totalCash: 63_400_000_000,
    accountsReceivable: 30_100_000_000,
    inventory: 7_200_000_000,
    totalCurrentAssets: 132_500_000_000,
    propertyPlantEquipment: 46_800_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 354_600_000_000,
    accountsPayable: 60_200_000_000,
    shortTermDebt: 10_100_000_000,
    totalCurrentLiabilities: 133_200_000_000,
    longTermDebt: 92_000_000_000,
    totalLiabilities: 291_800_000_000,
    totalStockholdersEquity: 62_800_000_000,
    retainedEarnings: -18_200_000_000,
    totalLiabilitiesAndEquity: 354_600_000_000,
  },
  {
    period: "Q4 FY25",
    periodEnd: "2025-09-27",
    isAnnual: false,
    cashAndEquivalents: 32_500_000_000,
    shortTermInvestments: 33_100_000_000,
    totalCash: 65_600_000_000,
    accountsReceivable: 35_200_000_000,
    inventory: 7_800_000_000,
    totalCurrentAssets: 138_200_000_000,
    propertyPlantEquipment: 47_200_000_000,
    goodwill: 0,
    intangibleAssets: 0,
    totalAssets: 360_400_000_000,
    accountsPayable: 72_300_000_000,
    shortTermDebt: 9_800_000_000,
    totalCurrentLiabilities: 138_600_000_000,
    longTermDebt: 91_200_000_000,
    totalLiabilities: 295_500_000_000,
    totalStockholdersEquity: 64_900_000_000,
    retainedEarnings: -14_800_000_000,
    totalLiabilitiesAndEquity: 360_400_000_000,
  },
];

const aaplCashFlow: CashFlowRow[] = [
  // ── Annual ──
  {
    period: "FY2024",
    periodEnd: "2024-09-28",
    isAnnual: true,
    netIncome: 104_826_000_000,
    depreciationAmortization: 11_500_000_000,
    stockBasedComp: 11_690_000_000,
    changeInWorkingCapital: -3_200_000_000,
    operatingCashFlow: 118_250_000_000,
    capitalExpenditures: -9_960_000_000,
    acquisitions: -2_100_000_000,
    investingCashFlow: -7_200_000_000,
    debtIssuance: 0,
    debtRepayment: -9_780_000_000,
    shareRepurchases: -94_950_000_000,
    dividendsPaid: -15_230_000_000,
    financingCashFlow: -120_420_000_000,
    freeCashFlow: 108_290_000_000,
    netChangeInCash: -9_370_000_000,
  },
  {
    period: "FY2025",
    periodEnd: "2025-09-27",
    isAnnual: true,
    netIncome: 111_900_000_000,
    depreciationAmortization: 12_200_000_000,
    stockBasedComp: 12_800_000_000,
    changeInWorkingCapital: -2_800_000_000,
    operatingCashFlow: 126_400_000_000,
    capitalExpenditures: -11_200_000_000,
    acquisitions: -1_500_000_000,
    investingCashFlow: -8_400_000_000,
    debtIssuance: 0,
    debtRepayment: -8_500_000_000,
    shareRepurchases: -100_200_000_000,
    dividendsPaid: -15_600_000_000,
    financingCashFlow: -124_600_000_000,
    freeCashFlow: 115_200_000_000,
    netChangeInCash: -6_600_000_000,
  },
  // ── Quarterly ──
  {
    period: "Q1 FY24",
    periodEnd: "2023-12-30",
    isAnnual: false,
    netIncome: 33_320_000_000,
    depreciationAmortization: 2_840_000_000,
    stockBasedComp: 2_950_000_000,
    changeInWorkingCapital: 2_100_000_000,
    operatingCashFlow: 39_900_000_000,
    capitalExpenditures: -2_610_000_000,
    acquisitions: -200_000_000,
    investingCashFlow: 1_200_000_000,
    debtIssuance: 0,
    debtRepayment: -3_800_000_000,
    shareRepurchases: -23_400_000_000,
    dividendsPaid: -3_810_000_000,
    financingCashFlow: -30_240_000_000,
    freeCashFlow: 37_290_000_000,
    netChangeInCash: 10_860_000_000,
  },
  {
    period: "Q2 FY24",
    periodEnd: "2024-03-30",
    isAnnual: false,
    netIncome: 22_940_000_000,
    depreciationAmortization: 2_870_000_000,
    stockBasedComp: 2_890_000_000,
    changeInWorkingCapital: -4_500_000_000,
    operatingCashFlow: 22_700_000_000,
    capitalExpenditures: -2_380_000_000,
    acquisitions: -500_000_000,
    investingCashFlow: -3_800_000_000,
    debtIssuance: 0,
    debtRepayment: -2_100_000_000,
    shareRepurchases: -23_600_000_000,
    dividendsPaid: -3_810_000_000,
    financingCashFlow: -29_860_000_000,
    freeCashFlow: 20_320_000_000,
    netChangeInCash: -10_960_000_000,
  },
  {
    period: "Q3 FY24",
    periodEnd: "2024-06-29",
    isAnnual: false,
    netIncome: 24_910_000_000,
    depreciationAmortization: 2_910_000_000,
    stockBasedComp: 2_940_000_000,
    changeInWorkingCapital: -1_200_000_000,
    operatingCashFlow: 28_900_000_000,
    capitalExpenditures: -2_530_000_000,
    acquisitions: -800_000_000,
    investingCashFlow: -1_400_000_000,
    debtIssuance: 0,
    debtRepayment: -1_780_000_000,
    shareRepurchases: -26_000_000_000,
    dividendsPaid: -3_810_000_000,
    financingCashFlow: -31_520_000_000,
    freeCashFlow: 26_370_000_000,
    netChangeInCash: -4_020_000_000,
  },
  {
    period: "Q4 FY24",
    periodEnd: "2024-09-28",
    isAnnual: false,
    netIncome: 23_656_000_000,
    depreciationAmortization: 2_880_000_000,
    stockBasedComp: 2_910_000_000,
    changeInWorkingCapital: 400_000_000,
    operatingCashFlow: 26_750_000_000,
    capitalExpenditures: -2_440_000_000,
    acquisitions: -600_000_000,
    investingCashFlow: -3_200_000_000,
    debtIssuance: 0,
    debtRepayment: -2_100_000_000,
    shareRepurchases: -21_950_000_000,
    dividendsPaid: -3_800_000_000,
    financingCashFlow: -28_800_000_000,
    freeCashFlow: 24_310_000_000,
    netChangeInCash: -5_250_000_000,
  },
  {
    period: "Q1 FY25",
    periodEnd: "2024-12-28",
    isAnnual: false,
    netIncome: 35_210_000_000,
    depreciationAmortization: 3_020_000_000,
    stockBasedComp: 3_150_000_000,
    changeInWorkingCapital: 2_500_000_000,
    operatingCashFlow: 42_300_000_000,
    capitalExpenditures: -2_900_000_000,
    acquisitions: -300_000_000,
    investingCashFlow: 1_100_000_000,
    debtIssuance: 0,
    debtRepayment: -2_400_000_000,
    shareRepurchases: -25_800_000_000,
    dividendsPaid: -3_900_000_000,
    financingCashFlow: -32_400_000_000,
    freeCashFlow: 39_400_000_000,
    netChangeInCash: 11_000_000_000,
  },
  {
    period: "Q2 FY25",
    periodEnd: "2025-03-29",
    isAnnual: false,
    netIncome: 24_930_000_000,
    depreciationAmortization: 3_050_000_000,
    stockBasedComp: 3_200_000_000,
    changeInWorkingCapital: -4_100_000_000,
    operatingCashFlow: 25_500_000_000,
    capitalExpenditures: -2_700_000_000,
    acquisitions: -400_000_000,
    investingCashFlow: -3_600_000_000,
    debtIssuance: 0,
    debtRepayment: -2_200_000_000,
    shareRepurchases: -24_600_000_000,
    dividendsPaid: -3_900_000_000,
    financingCashFlow: -31_000_000_000,
    freeCashFlow: 22_800_000_000,
    netChangeInCash: -9_100_000_000,
  },
  {
    period: "Q3 FY25",
    periodEnd: "2025-06-28",
    isAnnual: false,
    netIncome: 26_030_000_000,
    depreciationAmortization: 3_080_000_000,
    stockBasedComp: 3_250_000_000,
    changeInWorkingCapital: -1_000_000_000,
    operatingCashFlow: 30_200_000_000,
    capitalExpenditures: -2_800_000_000,
    acquisitions: -500_000_000,
    investingCashFlow: -2_500_000_000,
    debtIssuance: 0,
    debtRepayment: -1_900_000_000,
    shareRepurchases: -27_200_000_000,
    dividendsPaid: -3_900_000_000,
    financingCashFlow: -33_000_000_000,
    freeCashFlow: 27_400_000_000,
    netChangeInCash: -5_300_000_000,
  },
  {
    period: "Q4 FY25",
    periodEnd: "2025-09-27",
    isAnnual: false,
    netIncome: 25_730_000_000,
    depreciationAmortization: 3_050_000_000,
    stockBasedComp: 3_200_000_000,
    changeInWorkingCapital: -200_000_000,
    operatingCashFlow: 28_400_000_000,
    capitalExpenditures: -2_800_000_000,
    acquisitions: -300_000_000,
    investingCashFlow: -3_400_000_000,
    debtIssuance: 0,
    debtRepayment: -2_000_000_000,
    shareRepurchases: -22_600_000_000,
    dividendsPaid: -3_900_000_000,
    financingCashFlow: -28_200_000_000,
    freeCashFlow: 25_600_000_000,
    netChangeInCash: -3_200_000_000,
  },
];

// ── Assembled AAPL Financials ───────────────────────────────────────────────

const aaplFinancials: Financials = {
  incomeStatement: aaplIncomeStatement,
  balanceSheet: aaplBalanceSheet,
  cashFlow: aaplCashFlow,
};

// ── Revenue Scale Factors (relative to AAPL ~$395B FY2024) ──────────────────

const revenueScaleFactors: Record<string, number> = {
  AAPL: 1.0,
  MSFT: 0.63,   // ~$245B
  GOOGL: 0.86,  // ~$340B
  AMZN: 1.58,   // ~$620B
  META: 0.40,   // ~$160B
  NVDA: 0.31,   // ~$120B (FY2025 ending Jan 2025)
};

// Margin profiles differ by company — we adjust key ratios
const marginProfiles: Record<string, {
  grossMargin: number;
  opMarginAdj: number;
  netMarginAdj: number;
  rdPct: number;
  sgaPct: number;
}> = {
  AAPL: { grossMargin: 1.0, opMarginAdj: 1.0, netMarginAdj: 1.0, rdPct: 1.0, sgaPct: 1.0 },
  MSFT: { grossMargin: 1.49, opMarginAdj: 1.38, netMarginAdj: 1.36, rdPct: 1.3, sgaPct: 1.1 },
  GOOGL: { grossMargin: 1.23, opMarginAdj: 0.96, netMarginAdj: 1.04, rdPct: 1.6, sgaPct: 0.9 },
  AMZN: { grossMargin: 1.03, opMarginAdj: 0.33, netMarginAdj: 0.31, rdPct: 2.0, sgaPct: 0.4 },
  META: { grossMargin: 1.74, opMarginAdj: 1.27, netMarginAdj: 1.35, rdPct: 1.6, sgaPct: 0.6 },
  NVDA: { grossMargin: 1.60, opMarginAdj: 1.92, netMarginAdj: 2.10, rdPct: 0.8, sgaPct: 0.3 },
};

function scaleIncomeStatement(
  row: IncomeStatementRow,
  scale: number,
  profile: typeof marginProfiles.AAPL,
  ticker: string
): IncomeStatementRow {
  const revenue = Math.round(row.revenue * scale);
  const grossMarginPct = row.grossMargin * profile.grossMargin / 100;
  const grossProfit = Math.round(revenue * Math.min(grossMarginPct, 0.85));
  const costOfRevenue = revenue - grossProfit;
  const rd = Math.round(row.researchAndDevelopment * scale * profile.rdPct);
  const sga = Math.round(row.sellingGeneralAdmin * scale * profile.sgaPct);
  const totalOpex = costOfRevenue + rd + sga;
  const operatingIncome = revenue - totalOpex;
  const opMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
  const interestExpense = Math.round(row.interestExpense * scale * 0.6);
  const otherIncome = Math.round(row.otherIncome * scale);
  const pretaxIncome = operatingIncome - interestExpense + otherIncome;
  const taxRate = 0.166;
  const incomeTax = Math.round(pretaxIncome * taxRate);
  const netIncome = pretaxIncome - incomeTax;
  const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
  const shares = Math.round(row.sharesOutstanding * (ticker === "AMZN" ? 0.67 : ticker === "NVDA" ? 1.6 : ticker === "META" ? 0.166 : ticker === "GOOGL" ? 0.8 : ticker === "MSFT" ? 0.486 : 1));
  const sharesDil = Math.round(shares * 1.01);
  const eps = shares > 0 ? Math.round((netIncome / shares) * 100) / 100 : 0;
  const epsDiluted = sharesDil > 0 ? Math.round((netIncome / sharesDil) * 100) / 100 : 0;
  const dna = aaplCashFlow.find(cf => cf.period === row.period)?.depreciationAmortization ?? 11_000_000_000;
  const ebitda = Math.round(operatingIncome + dna * scale * 1.2);

  return {
    period: row.period,
    periodEnd: row.periodEnd,
    isAnnual: row.isAnnual,
    revenue,
    costOfRevenue,
    grossProfit,
    grossMargin: Math.round(grossMarginPct * 1000) / 10,
    researchAndDevelopment: rd,
    sellingGeneralAdmin: sga,
    totalOperatingExpenses: totalOpex,
    operatingIncome,
    operatingMargin: Math.round(opMargin * 10) / 10,
    interestExpense,
    otherIncome,
    pretaxIncome,
    incomeTax,
    netIncome,
    netMargin: Math.round(netMargin * 10) / 10,
    eps,
    epsDiluted,
    sharesOutstanding: shares,
    sharesDiluted: sharesDil,
    ebitda,
  };
}

function scaleBalanceSheet(
  row: BalanceSheetRow,
  scale: number
): BalanceSheetRow {
  const s = (v: number) => Math.round(v * scale);
  return {
    period: row.period,
    periodEnd: row.periodEnd,
    isAnnual: row.isAnnual,
    cashAndEquivalents: s(row.cashAndEquivalents),
    shortTermInvestments: s(row.shortTermInvestments),
    totalCash: s(row.totalCash),
    accountsReceivable: s(row.accountsReceivable),
    inventory: s(row.inventory),
    totalCurrentAssets: s(row.totalCurrentAssets),
    propertyPlantEquipment: s(row.propertyPlantEquipment),
    goodwill: s(row.goodwill),
    intangibleAssets: s(row.intangibleAssets),
    totalAssets: s(row.totalAssets),
    accountsPayable: s(row.accountsPayable),
    shortTermDebt: s(row.shortTermDebt),
    totalCurrentLiabilities: s(row.totalCurrentLiabilities),
    longTermDebt: s(row.longTermDebt),
    totalLiabilities: s(row.totalLiabilities),
    totalStockholdersEquity: s(row.totalStockholdersEquity),
    retainedEarnings: s(row.retainedEarnings),
    totalLiabilitiesAndEquity: s(row.totalLiabilitiesAndEquity),
  };
}

function scaleCashFlow(
  row: CashFlowRow,
  scale: number
): CashFlowRow {
  const s = (v: number) => Math.round(v * scale);
  return {
    period: row.period,
    periodEnd: row.periodEnd,
    isAnnual: row.isAnnual,
    netIncome: s(row.netIncome),
    depreciationAmortization: s(row.depreciationAmortization),
    stockBasedComp: s(row.stockBasedComp),
    changeInWorkingCapital: s(row.changeInWorkingCapital),
    operatingCashFlow: s(row.operatingCashFlow),
    capitalExpenditures: s(row.capitalExpenditures),
    acquisitions: s(row.acquisitions),
    investingCashFlow: s(row.investingCashFlow),
    debtIssuance: s(row.debtIssuance),
    debtRepayment: s(row.debtRepayment),
    shareRepurchases: s(row.shareRepurchases),
    dividendsPaid: s(row.dividendsPaid),
    financingCashFlow: s(row.financingCashFlow),
    freeCashFlow: s(row.freeCashFlow),
    netChangeInCash: s(row.netChangeInCash),
  };
}

// ── Exported Financials Data ────────────────────────────────────────────────

export const financialsData: Record<string, Financials> = {
  AAPL: aaplFinancials,
};

// Pre-generate for the other tickers
for (const ticker of ["MSFT", "GOOGL", "AMZN", "META", "NVDA"]) {
  const scale = revenueScaleFactors[ticker];
  const profile = marginProfiles[ticker];
  financialsData[ticker] = {
    incomeStatement: aaplIncomeStatement.map((row) =>
      scaleIncomeStatement(row, scale, profile, ticker)
    ),
    balanceSheet: aaplBalanceSheet.map((row) => scaleBalanceSheet(row, scale)),
    cashFlow: aaplCashFlow.map((row) => scaleCashFlow(row, scale)),
  };
}

/**
 * Get financials for any ticker. Returns AAPL data if ticker not found
 * (scaled to approximate size). Useful as a fallback.
 */
export function getFinancialsForTicker(ticker: string, periodType?: "annual" | "quarterly"): Financials {
  let data: Financials;
  if (financialsData[ticker]) {
    data = financialsData[ticker];
  } else {
    // Fallback: return AAPL data scaled to ~50% (generic mid-cap tech)
    const fallbackScale = 0.5;
    const fallbackProfile = marginProfiles.AAPL;
    data = {
      incomeStatement: aaplIncomeStatement.map((row) =>
        scaleIncomeStatement(row, fallbackScale, fallbackProfile, ticker)
      ),
      balanceSheet: aaplBalanceSheet.map((row) =>
        scaleBalanceSheet(row, fallbackScale)
      ),
      cashFlow: aaplCashFlow.map((row) => scaleCashFlow(row, fallbackScale)),
    };
  }

  // Filter by period type if specified
  if (periodType) {
    const isAnnual = periodType === "annual";
    return {
      incomeStatement: data.incomeStatement.filter((r) => r.isAnnual === isAnnual),
      balanceSheet: data.balanceSheet.filter((r) => r.isAnnual === isAnnual),
      cashFlow: data.cashFlow.filter((r) => r.isAnnual === isAnnual),
    };
  }

  return data;
}
